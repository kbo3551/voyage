<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdu.voyage.mapper.NoticeMapper">
	<!--공지사항 리스트 출력  -->
	<select id="selectNoticeList" resultType="com.gdu.voyage.vo.Notice">
		SELECT 
			notice_no, admin_id, notice_title, notice_view_cnt, create_date, update_date
		FROM notice 
		ORDER BY 
			notice_top='Y' DESC, update_date DESC
	</select>
	<select id="selectNoticeFileList" resultType="com.gdu.voyage.vo.NoticeFile">
			SELECT
				notice_no noticedNo,
				notice_file_name fileName,
				notice_file_ext fileExt
			FROM
				noticeFile
	</select> 
	<!-- 공지사항 insert -->
	<insert id="inserNotice" parameterType="com.gdu.voyage.vo.Notice">
	   	INSERT INTO notice(
			admin_id,
			notice_title,
			notice_content,
			create_date,
			update_date
		) VALUES(
			#{adminId},
			#{noticeTitle},
			#{noticeContent},
			Now(),
			Now()
		) 
	</insert>
	<!-- 파일 insert -->
	<insert id="insertNoticefile" parameterType="com.gdu.voyage.vo.NoticeFile">
		INSERT INTO notice_file (
			notice_no,
			notice_file_name,
			notice_file_ext,
			notice_file_size
		) VALUES (
			#{noticeNo},
			#{noticeFileName},
			#{noticeFileExt},
			#{noticeFileSize}
		)
	</insert>
	<!-- 공지사항 delete -->
	<delete id="deleteNotice" parameterType="com.gdu.voyage.vo.Notice">
		DELETE FROM notice WHERE notice_no=#{noticeNo}
	</delete>
	
	<delete id="deleteNoticeFile" parameterType="com.gdu.voyage.vo.NoticeFile">
		DELETE FROM noticeFile WHERE notice_no=#{noticeNo}
	</delete>
	<!-- 공지사항 update -->
	<!-- 파일(사진)은 수정될 때 추가,삭제,유지만 가능 -->
	<update id="updateNotice" parameterType="com.gdu.voyage.vo.Notice">
		UPDATE notice SET 
			notice_title = #{noticeTitle},
			notice_content = #{noticeContent},
			update_date = NOW()
		WHERE 
			notice_no = #{noticeNo}
	</update>

	<!-- 공지사항 One(상세보기) -->
	<select id="selectNoticeOne" resultType="com.gdu.voyage.vo.Notice">
		SELECT * FROM 
			notice 
		WHERE notice_no = #{noticeNo}
	</select>
</mapper>